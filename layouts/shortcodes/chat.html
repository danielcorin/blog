{{ $model := .Get "model" }}
{{ $link := .Get "link" }}
{{ $user := .Get "user" | default "user" }}
{{ $json := .Inner | unmarshal }}

<div class="chat-container">
    <div class="chat-header">
        <span class="chat-model">{{ $model }}</span>
    </div>
    <div class="chat-messages">
        {{ range $json }}
        <div class="chat-message {{ .role }}">
            <div class="chat-role">{{ if eq .role "user" }}{{ $user }}{{ else }}{{ .role }}{{ end }}</div>
            <div class="chat-content">
                {{ if reflect.IsSlice .content }}
                {{ range .content }}
                {{ if eq .type "text" }}
                <div>{{ .text | markdownify }}</div>
                {{ else if eq .type "image_url" }}
                <div>
                    <a href="{{ .image_url.url }}" target="_blank">
                        <img src="{{ .image_url.url }}" alt="Image" style="max-width: 75%; height: auto;" />
                    </a>
                </div>
                {{ end }}
                {{ end }}
                {{ else }}
                <div>{{ .content | markdownify }}</div>
                {{ end }}
            </div>
        </div>
        {{ end }}
    </div>
</div>
