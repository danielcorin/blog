{{ define "main" }}
<h1>{{ .Title }}</h1>
<p>{{ .Content }}</p>
<div id="xml-feed-container"></div>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const container = document.getElementById('xml-feed-container');
  const feedUrl = '{{ .Params.feed_url }}';

  fetch(feedUrl)
    .then(response => response.text())
    .then(str => new window.DOMParser().parseFromString(str, "text/xml"))
    .then(data => {
      const items = data.querySelectorAll('item');
      items.forEach(item => {
        const title = item.querySelector('title').textContent;
        const link = item.querySelector('link').textContent;
        const pubDate = item.querySelector('pubDate').textContent;
        container.innerHTML += `
          <article>
            <h4><a href="${link}">${title}</a></h4>
            <time>${new Date(pubDate).toISOString().split('T')[0]}</time>
          </article>
        `;
      });
    })
    .catch(error => {
      console.error('Error fetching feed:', error);
      container.innerHTML = '<p>Error loading feed. Please try again later.</p>';
    });
});
</script>
<footer class="footnote">
  <p>Feed provided by <a href="https://raindrop.io/">Raindrop.io</a></p>
  <p>View this feed in your <a href="{{ .Params.browser_url }}">browser</a> or access the <a href="{{ .Params.feed_url }}">raw XML</a></p>
</footer>

{{ end }}
